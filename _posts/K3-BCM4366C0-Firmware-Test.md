---
title: K3 运行 LEDE 时 BCM4366C0 的固件性能测试
date: 2017-04-02 16:49:28
tags:
---

K3 里面是 BCM4366C0，这个型号的 firmware 没有公开可用的。公开版本只到 BCM4366B1. （这样一说，会不会 BCM4366C0 就是专门用在路由器上的型号呢？正好就不提供固件，不给第三方）

算了，不扯这个，网卡本身还是受 brcmfmac 支持的，固件可以从官方的 dhd.ko 里面提取，合起来就可以用了。提取方法如下：

1. `readelf -a dhd.ko | grep 4366c0` 会看到有一个 `dlarray_4366c0` 的条目。前面有一个十六进制表示的大小，数量级大概在 0xf0000 左右，记下它，它是**固件大小**。
2. 用十六进制编辑器打开 dhd.ko，搜索 `00 F2 3E B8` 这个串，会看到有多个条目。在每个匹配处前面**一般**会有文本描述，挑一个写着 4366c0 的位置，记住它的**偏移量**. 有时候前面没有文本，就都提取出来好了。而且这个串可能在几十个字节内重复出现两次，应该取前一次作为固件起点偏移量。
3. `dd if=dhd.ko of=4366c0-fw.bin ibs=1 skip=偏移量 count=固件大小` 提取出的固件文件应该以 `00 F2 3E B8` 开头，以一段可读文本加四字节不知道啥玩意结尾。

现在可以从 Linksys EA9500、Asus RT-AC88U/AC3100/AC5300、Netgear R8500 以及 K3 自己的系统镜像中提取固件，下面将逐一测试这些固件的性能。测试将包含以下项目：

* 系统兼容性（hostapd 带起来的过程中是否有错误，是否能输出终端连接和断开信息）
* 放在特定位置的手机对 2.4GHz 和 5GHz 信号的接收强度
* 电脑测速（黑苹果 BCM4360）

设备放置：路由左边 10cm 是电脑，电脑左边 10cm 是手机。问我为什么不隔开一点？因为网线只有那么长。无线都设置 WPA2-PSK-AES 加密，密码 12345678.

## Linksys EA9500 固件

### 2.4GHz


